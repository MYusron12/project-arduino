if (self.CavalryLogger) { CavalryLogger.start_js(["idaKK"]); }

__d("MessengerSearchLoggerUtil",["MessengerSearchFunnelLoggerConstants"],(function(a,b,c,d,e,f){"use strict";function a(a){var c;switch(a){case"thread":c=b("MessengerSearchFunnelLoggerConstants").GROUP;break;case"friend":c=b("MessengerSearchFunnelLoggerConstants").USER_CONTACT;break;case"message":c=b("MessengerSearchFunnelLoggerConstants").MESSAGE;break;case"non_friend":c=b("MessengerSearchFunnelLoggerConstants").USER_NON_CONTACT;break;case"fb4c":c=b("MessengerSearchFunnelLoggerConstants").COWORKER;break;case"game":c=b("MessengerSearchFunnelLoggerConstants").GAME;break;case"page":case"internal_bot_page":case"commerce_page":case"meeting_room_page":c=b("MessengerSearchFunnelLoggerConstants").PAGE;break;default:c=b("MessengerSearchFunnelLoggerConstants").OTHER}return c}e.exports={getLoggingTypeFromMercuryType:a}}),null);
__d("MessengerTypeaheadView.react",["cx","Bootloader","MessengerContactAdapters","MessengerContactList.react","MessengerSearchFunnelLoggerConstants","MessengerSearchLoggerUtil","MessengerTypeaheadUtils","MessengerUniversalSearchFunnelLoggerConstants","React","compactArray","immutable","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={isExpectingEntriesUpdate:!1,localEntries:[]},d.$1=b("immutable").OrderedMap(),d.$2=function(a,b){d.props.onSelect&&d.props.onSelect(a,b)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidUpdate=function(a,c){var d=this;this.$1=b("MessengerTypeaheadUtils").buildListSections(this.props.entries,this.props.queryString);if(a.isLoading&&!this.props.isLoading&&this.props.queryString!==""){this.$3({name:b("MessengerSearchFunnelLoggerConstants").FETCHED_STATE_IMPRESSION_LIST,queryString:this.props.queryString,entries:this.props.entries.map(function(a){return a.getUniqueID()})});var e=this.$1.mapEntries(function(a){var d=a[0];a=a[1];a=a.map(function(a){var e=a.getUniqueID();return{result_fbid:e,result_type:b("MessengerSearchLoggerUtil").getLoggingTypeFromMercuryType(a.getType()),rank_section:d.toString(),data_source:[c.localEntries.includes(e)?b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.LOCAL:b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.SERVER_XCONTROLLER]}});return[d.toString(),b("compactArray")(a)]}),f=[];e.forEach(function(a){f=f.concat(a)});var g=b("immutable").OrderedMap();f.forEach(function(a){g=g.set(a.result_fbid,a)});b("Bootloader").loadModules(["MessengerUniversalSearchFunnelLogger"],function(a){a.logImpressions(g,d.props.queryString,b("MessengerUniversalSearchFunnelLoggerConstants").RESULT_SURFACES.TYPEAHEAD,b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.LOCAL_AND_SERVER)},"MessengerTypeaheadView.react");this.setState({isExpectingEntriesUpdate:!1})}else if(a.isLoading&&this.state.isExpectingEntriesUpdate){e=this.props.entries.map(function(a){return a.getUniqueID()});this.$3({name:b("MessengerSearchFunnelLoggerConstants").LOADING_STATE_IMPRESSION_LIST,queryString:this.props.queryString,entries:e});b("Bootloader").loadModules(["MessengerUniversalSearchFunnelLogger"],function(a){var c=d.props.entries.map(function(a){var c=a.getUniqueID();a=a.getType();return[c,{result_fbid:c,result_type:b("MessengerSearchLoggerUtil").getLoggingTypeFromMercuryType(a),rank_section:b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.LOCAL,data_source:[b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.LOCAL]}]});c=b("immutable").OrderedMap(c);a.logImpressions(c,d.props.queryString,b("MessengerUniversalSearchFunnelLoggerConstants").RESULT_SURFACES.TYPEAHEAD,b("MessengerUniversalSearchFunnelLoggerConstants").SOURCES.LOCAL)},"MessengerTypeaheadView.react");this.setState({isExpectingEntriesUpdate:!1,localEntries:e})}a.queryString!==this.props.queryString&&this.setState({isExpectingEntriesUpdate:!0})};d.render=function(){var a;return h.jsx(b("MessengerContactList.react"),{controlleeID:this.props.controlleeID,className:b("joinClasses")(this.props.className,"_4p-s"),contactAdapter:b("MessengerContactAdapters").fromSearchableEntry,hasHoverState:this.props.hasHoverState,highlightedEntry:this.props.highlightedEntry,isLoading:this.props.isLoading,listSections:this.$1,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight,onScrollIntoView:this.props.onScrollIntoView,onSelect:this.$2,originalEntryIDs:this.props.originalEntryIDs,invitedEntryIDs:this.props.invitedEntryIDs,queryString:this.props.queryString,selectedEntryIDs:this.props.selectedEntryIDs,showPresence:!1,viewer:this.props.viewer,rowComponent:this.props.rowComponent,useDarkTheme:(a=this.props.useDarkTheme)!=null?a:!1})};d.$3=function(a){b("Bootloader").loadModules(["MessengerSearchFunnelLogger"],function(c){switch(a.name){case b("MessengerSearchFunnelLoggerConstants").LOADING_STATE_IMPRESSION_LIST:c.logLoadingStateQuery(b("MessengerSearchFunnelLoggerConstants").NAME,a.queryString,a.entries);break;case b("MessengerSearchFunnelLoggerConstants").FETCHED_STATE_IMPRESSION_LIST:c.logUpdateQuery(b("MessengerSearchFunnelLoggerConstants").NAME,b("MessengerSearchFunnelLoggerConstants").FETCHED_STATE_IMPRESSION_LIST,a.queryString,a.entries);break}},"MessengerTypeaheadView.react")};return c}(h.PureComponent);a.propTypes={controlleeID:(c=b("prop-types")).string,entries:c.array.isRequired,hasHoverState:c.bool,highlightedEntry:c.object,isLoading:c.bool,onHighlight:c.func,onRenderHighlight:c.func,onScrollIntoView:c.func,onSelect:c.func,originalEntryIDs:c.instanceOf(b("immutable").Set),invitedEntryIDs:c.instanceOf(b("immutable").Set),queryString:c.string,selectedEntryIDs:c.instanceOf(b("immutable").Set),viewer:c.string.isRequired,rowComponent:c.func,useDarkTheme:c.bool};e.exports=a}),null);
__d("ChatTypeaheadWrapper.react",["cx","Arbiter","Bootloader","ChatOpenTabEventLogger","ChatSidebarActions","ChatSidebarComposeLink.react","ChatSidebarDropdown.react","ChatSidebarGroupCreateButtonReact.bs","ChatSidebarSheet.react","ChatSidebarVideoCallLink.react","ChatTypeaheadConstants","FantaTabActions","MeetupExperiments","MercuryIDs","MessengerConfig","MessengerSearchTypeahead.react","React","WorkSMBHelpSidebar","emptyFunction","getActiveElement","gkx","ifRequired","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React"),i=b("WorkSMBHelpSidebar").module,j=40;function k(a){b("Arbiter").inform("sidebar/typeahead/active",a)}var l=b("qex")._("1211265"),m=b("qex")._("1211264"),n=b("MeetupExperiments").supportLinkCreationInChatSideBar();a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={height:0,value:c.getInitialQueryString(),isSearching:!!c.getInitialQueryString()},c.$1=function(){c.setState({isSearching:!1,value:""})},c.$2=function(a){a&&c.setState({isSearching:!0})},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getInitialQueryString=function(){var a="";b("gkx")("678264")&&b("ifRequired")("ChatTypeaheadCore",function(b){a=b.getLastSearchQuery()});return a?a:""};d.componentDidMount=function(){var a=this;b("gkx")("678264")&&(b("ifRequired")("ChatTypeaheadCore",function(a){a.processInteractionsQueue()}),this.getInitialQueryString()!==""&&k(!0));this.props.isSidebar?b("Arbiter").subscribe("sidebar/resized",function(b,c){a.setState({height:c})}):b("Arbiter").subscribe("buddyList/resized",function(b,c){a.setState({height:c})})};d.UNSAFE_componentWillUpdate=function(a,b){b.isSearching!==this.state.isSearching&&k(b.isSearching)};d.render=function(){var a=this,c=this.state.height!=null?Math.floor((this.state.height-j*2)/j):null,d=h.jsx(b("ChatSidebarComposeLink.react"),{className:"_3a-4 _5q85"}),e=m?null:h.jsx(b("ChatSidebarGroupCreateButtonReact.bs").make,{viewer:this.props.id}),f=n?h.jsx(b("ChatSidebarVideoCallLink.react"),{className:"_8_v6",isFullChatSideBar:!0}):null,g=h.jsx(b("ChatSidebarDropdown.react"),{sidebarType:"sidebar",onToggleSidebar:b("ChatSidebarActions").disable});return h.jsxs("div",{id:"chatsearch",children:[!this.state.isSearching&&i&&h.jsx(i,{}),b("gkx")("678264")?null:h.jsx(b("ChatSidebarSheet.react"),{className:"fbChatSidebarMessage",viewer:this.props.id,isSidebar:this.props.isSidebar}),l?null:h.jsx(b("MessengerSearchTypeahead.react"),{className:"_62it"+(n?" _8_v7":""),isFacebookChat:!0,isFocused:!0,maxEntries:c,queryString:this.state.value,viewer:this.props.id,onBlur:this.$1,onChange:function(c){var d=c.target.value;b("Bootloader").loadModules(["MessengerUniversalSearchFunnelLogger"],function(a){a.logQueryChanged(d)},"ChatTypeaheadWrapper.react");a.setState({isSearching:d!==""||b("MessengerConfig").NSDB===!0,value:d})},onClear:b("emptyFunction"),onFocus:this.$2,onScrollIntoView:b("emptyFunction"),onSelect:function(c,d){var e=b("getActiveElement")();e&&e.blur();if(d===b("ChatTypeaheadConstants").MEETING_ROOM_PAGE_TYPE)b("Bootloader").loadModules(["goURI"],function(d){a.setState({isSearching:!1,value:""});var e=b("MercuryIDs").getUserIDFromThreadID(c);d("/"+(e||""))},"ChatTypeaheadWrapper.react");else{b("FantaTabActions").openTab(c,["fb_search:chat_sidebar_typeahead"]);e=null;(!d||d==="friend"||d===b("ChatTypeaheadConstants").FRIEND_TYPE||d===b("ChatTypeaheadConstants").PAGE_TYPE||d===b("ChatTypeaheadConstants").USER_TYPE)&&(b("MercuryIDs").isValidThreadID(c)&&(e=b("MercuryIDs").getUserIDFromThreadID(c)));b("ChatOpenTabEventLogger").logClickOpen("typeahead",c,e)}}}),this.props.isSidebar?n?h.jsxs("div",{className:"_531b",children:[d,e,f,g]}):h.jsxs("div",{className:"_531b",children:[g,d,e]}):null]})};return c}(h.Component);e.exports=a}),null);